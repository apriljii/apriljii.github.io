<!DOCTYPE html>
<html lang=ch>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="本文将深入探讨 MS UI System 如何利用 pnpm workspace 实现大型组件库的 Monorepo 架构，涵盖包结构设计、依赖管理、版本控制和构建优化等关键技术点。  前言在前端工程化发展的今天，Monorepo（单一代码仓库）已成为大型项目和组件库的标准架构模式。MS UI System 采用 pnpm workspace 作为包管理工具，成功构建了一个包含多个子包的现代化组">
<meta property="og:type" content="article">
<meta property="og:title" content="企业级Vue组件库建设-2. Monorepo多包管理:pnpm-workspace的实践">
<meta property="og:url" content="https://apriljii.github.io/2024/01/22/02-monorepo-pnpm-workspace/index.html">
<meta property="og:site_name" content="April">
<meta property="og:description" content="本文将深入探讨 MS UI System 如何利用 pnpm workspace 实现大型组件库的 Monorepo 架构，涵盖包结构设计、依赖管理、版本控制和构建优化等关键技术点。  前言在前端工程化发展的今天，Monorepo（单一代码仓库）已成为大型项目和组件库的标准架构模式。MS UI System 采用 pnpm workspace 作为包管理工具，成功构建了一个包含多个子包的现代化组">
<meta property="og:locale">
<meta property="article:published_time" content="2024-01-22T08:21:23.000Z">
<meta property="article:modified_time" content="2026-01-15T10:14:59.178Z">
<meta property="article:author" content="April Ji">
<meta property="article:tag" content="Vue.js 组件库 前端架构 Monorepo pnpm 包管理">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>企业级Vue组件库建设-2. Monorepo多包管理:pnpm-workspace的实践</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
	<!-- mermaid -->
	<script src='https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js'></script>
	<script>
		mermaid.initialize({
			startOnLoad: true,
			theme: 'dark',
			securityLevel: 'loose'
		});
	</script>
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="https://github.com/apriljii">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2024/02/05/03-component-design-patterns/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2024/01/15/01-vue-enterprise-component-library/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://apriljii.github.io/2024/01/22/02-monorepo-pnpm-workspace/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://apriljii.github.io/2024/01/22/02-monorepo-pnpm-workspace/&text=企业级Vue组件库建设-2. Monorepo多包管理:pnpm-workspace的实践"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://apriljii.github.io/2024/01/22/02-monorepo-pnpm-workspace/&title=企业级Vue组件库建设-2. Monorepo多包管理:pnpm-workspace的实践"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://apriljii.github.io/2024/01/22/02-monorepo-pnpm-workspace/&is_video=false&description=企业级Vue组件库建设-2. Monorepo多包管理:pnpm-workspace的实践"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=企业级Vue组件库建设-2. Monorepo多包管理:pnpm-workspace的实践&body=Check out this article: https://apriljii.github.io/2024/01/22/02-monorepo-pnpm-workspace/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://apriljii.github.io/2024/01/22/02-monorepo-pnpm-workspace/&title=企业级Vue组件库建设-2. Monorepo多包管理:pnpm-workspace的实践"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://apriljii.github.io/2024/01/22/02-monorepo-pnpm-workspace/&title=企业级Vue组件库建设-2. Monorepo多包管理:pnpm-workspace的实践"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://apriljii.github.io/2024/01/22/02-monorepo-pnpm-workspace/&title=企业级Vue组件库建设-2. Monorepo多包管理:pnpm-workspace的实践"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://apriljii.github.io/2024/01/22/02-monorepo-pnpm-workspace/&title=企业级Vue组件库建设-2. Monorepo多包管理:pnpm-workspace的实践"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://apriljii.github.io/2024/01/22/02-monorepo-pnpm-workspace/&name=企业级Vue组件库建设-2. Monorepo多包管理:pnpm-workspace的实践&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://apriljii.github.io/2024/01/22/02-monorepo-pnpm-workspace/&t=企业级Vue组件库建设-2. Monorepo多包管理:pnpm-workspace的实践"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc-container">
        <div id="toc-toggle" class="toc-toggle-btn">
          <i class="fa-solid fa-list"></i>
          <span>Table of Contents</span>
        </div>
        <div id="toc" style="display: none;">
          <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E7%BB%84%E4%BB%B6%E5%BA%93%E7%9A%84%E5%8C%85%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E8%81%8C%E8%B4%A3%E5%88%92%E5%88%86"><span class="toc-number">2.</span> <span class="toc-text">一、组件库的包结构设计与职责划分</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88"><span class="toc-number">2.1.</span> <span class="toc-text">1.1 整体架构概览</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E5%8C%85%E8%81%8C%E8%B4%A3%E6%98%8E%E7%A1%AE%E5%88%92%E5%88%86"><span class="toc-number">2.2.</span> <span class="toc-text">1.2 包职责明确划分</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ms-ui-packages-core-%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6%E5%BA%93"><span class="toc-number">2.2.1.</span> <span class="toc-text">@ms&#x2F;ui (packages&#x2F;core) - 核心组件库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ms-lowcode-packages-lowcode-%E4%BD%8E%E4%BB%A3%E7%A0%81%E5%B9%B3%E5%8F%B0"><span class="toc-number">2.2.2.</span> <span class="toc-text">@ms&#x2F;lowcode (packages&#x2F;lowcode) - 低代码平台</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#docs-%E6%96%87%E6%A1%A3%E7%B3%BB%E7%BB%9F"><span class="toc-number">2.2.3.</span> <span class="toc-text">docs - 文档系统</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#examples-%E7%A4%BA%E4%BE%8B%E9%A1%B9%E7%9B%AE"><span class="toc-number">2.2.4.</span> <span class="toc-text">examples - 示例项目</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E5%8C%85%E9%97%B4%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB%E8%AE%BE%E8%AE%A1"><span class="toc-number">2.3.</span> <span class="toc-text">1.3 包间依赖关系设计</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81pnpm-workspace-%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%E4%B8%8E%E9%85%8D%E7%BD%AE%E5%AE%9E%E8%B7%B5"><span class="toc-number">3.</span> <span class="toc-text">二、pnpm workspace 的工作原理与配置实践</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-pnpm-workspace-%E6%A0%B8%E5%BF%83%E6%9C%BA%E5%88%B6"><span class="toc-number">3.1.</span> <span class="toc-text">2.1 pnpm workspace 核心机制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-Workspace-%E9%85%8D%E7%BD%AE%E7%9A%84%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">3.2.</span> <span class="toc-text">2.2 Workspace 配置的最佳实践</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%85%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83"><span class="toc-number">3.2.1.</span> <span class="toc-text">包命名规范</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E4%BE%9D%E8%B5%96%E5%BC%95%E7%94%A8"><span class="toc-number">3.2.2.</span> <span class="toc-text">本地依赖引用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-Workspace-%E7%9A%84%E4%BC%98%E5%8A%BF%E4%BD%93%E7%8E%B0"><span class="toc-number">3.3.</span> <span class="toc-text">2.3 Workspace 的优势体现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%9D%E8%B5%96%E7%89%88%E6%9C%AC%E7%BB%9F%E4%B8%80"><span class="toc-number">3.3.1.</span> <span class="toc-text">依赖版本统一</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A3%81%E7%9B%98%E7%A9%BA%E9%97%B4%E8%8A%82%E7%9C%81"><span class="toc-number">3.3.2.</span> <span class="toc-text">磁盘空间节省</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E6%95%88%E7%8E%87%E6%8F%90%E5%8D%87"><span class="toc-number">3.3.3.</span> <span class="toc-text">开发效率提升</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E3%80%81%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E4%B8%8E%E5%8F%91%E5%B8%83%E7%AD%96%E7%95%A5"><span class="toc-number">4.</span> <span class="toc-text">三、依赖管理、版本控制与发布策略</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E7%AD%96%E7%95%A5"><span class="toc-number">4.1.</span> <span class="toc-text">3.1 依赖管理策略</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%9F%E4%BA%A7%E4%BE%9D%E8%B5%96-vs-%E5%AF%B9%E7%AD%89%E4%BE%9D%E8%B5%96"><span class="toc-number">4.1.1.</span> <span class="toc-text">生产依赖 vs 对等依赖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%9D%E8%B5%96%E7%89%88%E6%9C%AC%E9%94%81%E5%AE%9A"><span class="toc-number">4.1.2.</span> <span class="toc-text">依赖版本锁定</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E7%AD%96%E7%95%A5"><span class="toc-number">4.2.</span> <span class="toc-text">3.2 版本控制策略</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%9F%E4%B8%80%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86"><span class="toc-number">4.2.1.</span> <span class="toc-text">统一版本管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%91%E5%B8%83%E6%B5%81%E7%A8%8B%E8%87%AA%E5%8A%A8%E5%8C%96"><span class="toc-number">4.2.2.</span> <span class="toc-text">发布流程自动化</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E5%8F%91%E5%B8%83%E7%AD%96%E7%95%A5%E8%AE%BE%E8%AE%A1"><span class="toc-number">4.3.</span> <span class="toc-text">3.3 发布策略设计</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%BA%A7%E5%8F%91%E5%B8%83%E7%AD%96%E7%95%A5"><span class="toc-number">4.3.1.</span> <span class="toc-text">分级发布策略</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%91%E5%B8%83%E6%B8%A0%E9%81%93%E8%AE%BE%E8%AE%A1"><span class="toc-number">4.3.2.</span> <span class="toc-text">发布渠道设计</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E8%B7%A8%E5%8C%85%E4%BB%A3%E7%A0%81%E5%85%B1%E4%BA%AB%E4%B8%8E%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96"><span class="toc-number">5.</span> <span class="toc-text">四、跨包代码共享与构建优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E4%BB%A3%E7%A0%81%E5%85%B1%E4%BA%AB%E6%9C%BA%E5%88%B6"><span class="toc-number">5.1.</span> <span class="toc-text">4.1 代码共享机制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7%E5%87%BD%E6%95%B0%E5%85%B1%E4%BA%AB"><span class="toc-number">5.1.1.</span> <span class="toc-text">工具函数共享</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89%E5%85%B1%E4%BA%AB"><span class="toc-number">5.1.2.</span> <span class="toc-text">类型定义共享</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96%E7%AD%96%E7%95%A5"><span class="toc-number">5.2.</span> <span class="toc-text">4.2 构建优化策略</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B9%B6%E8%A1%8C%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96"><span class="toc-number">5.2.1.</span> <span class="toc-text">并行构建优化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A2%9E%E9%87%8F%E6%9E%84%E5%BB%BA%E6%94%AF%E6%8C%81"><span class="toc-number">5.2.2.</span> <span class="toc-text">增量构建支持</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%87%BA%E4%BA%A7%E7%89%A9%E4%BC%98%E5%8C%96"><span class="toc-number">5.2.3.</span> <span class="toc-text">输出产物优化</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E5%AE%9E%E8%B7%B5%E7%BB%8F%E9%AA%8C%E4%B8%8E%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">6.</span> <span class="toc-text">五、实践经验与最佳实践</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E5%8C%85%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1%E7%9A%84%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93"><span class="toc-number">6.1.</span> <span class="toc-text">5.1 包结构设计的经验总结</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%81%8C%E8%B4%A3%E5%88%86%E7%A6%BB%E5%8E%9F%E5%88%99"><span class="toc-number">6.1.1.</span> <span class="toc-text">职责分离原则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%85%E5%A4%A7%E5%B0%8F%E6%8E%A7%E5%88%B6"><span class="toc-number">6.1.2.</span> <span class="toc-text">包大小控制</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E7%9A%84%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">6.2.</span> <span class="toc-text">5.2 依赖管理的最佳实践</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%9D%E8%B5%96%E7%89%88%E6%9C%AC%E7%AD%96%E7%95%A5"><span class="toc-number">6.2.1.</span> <span class="toc-text">依赖版本策略</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96%E9%81%BF%E5%85%8D"><span class="toc-number">6.2.2.</span> <span class="toc-text">循环依赖避免</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E5%8F%91%E5%B8%83%E6%B5%81%E7%A8%8B%E7%9A%84%E6%8C%81%E7%BB%AD%E4%BC%98%E5%8C%96"><span class="toc-number">6.3.</span> <span class="toc-text">5.3 发布流程的持续优化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8F%91%E5%B8%83%E6%B5%81%E6%B0%B4%E7%BA%BF"><span class="toc-number">6.3.1.</span> <span class="toc-text">自动化发布流水线</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%91%E5%B8%83%E5%89%8D%E6%A3%80%E6%9F%A5%E6%B8%85%E5%8D%95"><span class="toc-number">6.3.2.</span> <span class="toc-text">发布前检查清单</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E6%80%BB%E7%BB%93%E4%B8%8E%E5%B1%95%E6%9C%9B"><span class="toc-number">7.</span> <span class="toc-text">六、总结与展望</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%BD%93%E5%89%8D%E5%AE%9E%E7%8E%B0%E7%8A%B6%E6%80%81%E4%B8%8E%E4%BC%98%E5%8C%96%E8%AF%84%E4%BC%B0"><span class="toc-number">8.</span> <span class="toc-text">六、当前实现状态与优化评估</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E5%B7%B2%E5%AE%9E%E7%8E%B0%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="toc-number">8.1.</span> <span class="toc-text">6.1 已实现的功能</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%9C%85-%E5%9F%BA%E7%A1%80%E7%9A%84%E5%A4%9A%E5%8C%85%E6%9E%B6%E6%9E%84"><span class="toc-number">8.1.1.</span> <span class="toc-text">✅ 基础的多包架构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%9C%85-%E5%9F%BA%E7%A1%80%E7%9A%84%E6%9E%84%E5%BB%BA%E7%B3%BB%E7%BB%9F"><span class="toc-number">8.1.2.</span> <span class="toc-text">✅ 基础的构建系统</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%9C%85-%E5%8F%91%E5%B8%83%E5%92%8C%E5%88%86%E5%8F%91"><span class="toc-number">8.1.3.</span> <span class="toc-text">✅ 发布和分发</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E6%9C%AA%E5%AE%9E%E7%8E%B0%E7%9A%84%E4%BC%98%E5%8C%96"><span class="toc-number">8.2.</span> <span class="toc-text">6.2 未实现的优化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%9A%AB-%E8%B7%A8%E5%8C%85%E4%BB%A3%E7%A0%81%E5%85%B1%E4%BA%AB%E6%9C%BA%E5%88%B6"><span class="toc-number">8.2.1.</span> <span class="toc-text">🚫 跨包代码共享机制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%9A%AB-%E5%9F%BA%E4%BA%8E%E6%96%87%E4%BB%B6%E5%8F%98%E5%8C%96%E7%9A%84%E6%99%BA%E8%83%BD%E6%9E%84%E5%BB%BA"><span class="toc-number">8.2.2.</span> <span class="toc-text">🚫 基于文件变化的智能构建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%9A%AB-%E5%B9%B6%E8%A1%8C%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96"><span class="toc-number">8.2.3.</span> <span class="toc-text">🚫 并行构建优化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%9A%AB-%E8%BE%93%E5%87%BA%E4%BA%A7%E7%89%A9%E9%AB%98%E7%BA%A7%E4%BC%98%E5%8C%96"><span class="toc-number">8.2.4.</span> <span class="toc-text">🚫 输出产物高级优化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%9A%AB-%E5%A4%9A%E6%B8%A0%E9%81%93%E5%8F%91%E5%B8%83%E7%AD%96%E7%95%A5"><span class="toc-number">8.2.5.</span> <span class="toc-text">🚫 多渠道发布策略</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%9A%AB-%E5%8C%85%E5%A4%A7%E5%B0%8F%E5%92%8C%E6%9E%84%E5%BB%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7"><span class="toc-number">8.2.6.</span> <span class="toc-text">🚫 包大小和构建性能监控</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%9A%AB-CI-CD-%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%81%E6%B0%B4%E7%BA%BF"><span class="toc-number">8.2.7.</span> <span class="toc-text">🚫 CI&#x2F;CD 自动化流水线</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%9A%AB-%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB%E5%9B%BE%E5%88%86%E6%9E%90"><span class="toc-number">8.2.8.</span> <span class="toc-text">🚫 依赖关系图分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-%E5%BD%93%E5%89%8D%E6%9E%84%E5%BB%BA%E6%B5%81%E7%A8%8B%E7%9A%84%E5%AE%9E%E9%99%85%E6%83%85%E5%86%B5"><span class="toc-number">8.3.</span> <span class="toc-text">6.3 当前构建流程的实际情况</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-%E6%8A%80%E6%9C%AF%E5%80%BA%E5%8A%A1%E4%B8%8E%E6%94%B9%E8%BF%9B%E5%BB%BA%E8%AE%AE"><span class="toc-number">8.4.</span> <span class="toc-text">6.4 技术债务与改进建议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9F%AD%E6%9C%9F%E6%94%B9%E8%BF%9B%EF%BC%881-2-%E5%91%A8%E5%86%85%E5%8F%AF%E5%AE%8C%E6%88%90%EF%BC%89"><span class="toc-number">8.4.1.</span> <span class="toc-text">短期改进（1-2 周内可完成）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%AD%E6%9C%9F%E6%94%B9%E8%BF%9B%EF%BC%881-%E4%B8%AA%E6%9C%88%E5%86%85%EF%BC%89"><span class="toc-number">8.4.2.</span> <span class="toc-text">中期改进（1 个月内）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%95%BF%E6%9C%9F%E8%A7%84%E5%88%92%EF%BC%883-%E4%B8%AA%E6%9C%88-%EF%BC%89"><span class="toc-number">8.4.3.</span> <span class="toc-text">长期规划（3 个月+）</span></a></li></ol></li></ol></li></ol>
        </div>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        企业级Vue组件库建设-2. Monorepo多包管理:pnpm-workspace的实践
    </h1>
    



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">April Ji</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-01-22T08:21:23.000Z" class="dt-published" itemprop="datePublished">2024-01-22</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/Vue-js-%E7%BB%84%E4%BB%B6%E5%BA%93-%E5%89%8D%E7%AB%AF%E6%9E%B6%E6%9E%84-Monorepo-pnpm-%E5%8C%85%E7%AE%A1%E7%90%86/" rel="tag">Vue.js 组件库 前端架构 Monorepo pnpm 包管理</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <blockquote>
<p>本文将深入探讨 MS UI System 如何利用 pnpm workspace 实现大型组件库的 Monorepo 架构，涵盖包结构设计、依赖管理、版本控制和构建优化等关键技术点。</p>
</blockquote>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在前端工程化发展的今天，Monorepo（单一代码仓库）已成为大型项目和组件库的标准架构模式。MS UI System 采用 pnpm workspace 作为包管理工具，成功构建了一个包含多个子包的现代化组件库系统。本文将分享我们在 Monorepo 实践中的技术选型、架构设计和最佳实践。</p>
<h2 id="一、组件库的包结构设计与职责划分"><a href="#一、组件库的包结构设计与职责划分" class="headerlink" title="一、组件库的包结构设计与职责划分"></a>一、组件库的包结构设计与职责划分</h2><h3 id="1-1-整体架构概览"><a href="#1-1-整体架构概览" class="headerlink" title="1.1 整体架构概览"></a>1.1 整体架构概览</h3><p>MS UI System 采用了经典的分层架构设计，将不同功能模块划分到独立的包中：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ms-ui-system/</span><br><span class="line">├── packages/</span><br><span class="line">│   ├── core/                 # 核心组件库</span><br><span class="line">│   └── lowcode/              # 低代码平台</span><br><span class="line">├── docs/                     # 文档系统</span><br><span class="line">├── examples/                 # 示例项目</span><br><span class="line">└── pnpm-workspace.yaml       # Workspace 配置</span><br></pre></td></tr></table></figure>

<h3 id="1-2-包职责明确划分"><a href="#1-2-包职责明确划分" class="headerlink" title="1.2 包职责明确划分"></a>1.2 包职责明确划分</h3><h4 id="ms-ui-packages-core-核心组件库"><a href="#ms-ui-packages-core-核心组件库" class="headerlink" title="@ms/ui (packages/core) - 核心组件库"></a>@ms/ui (packages/core) - 核心组件库</h4><p><strong>职责范围：</strong></p>
<ul>
<li>Vue 2.x 组件库的完整实现</li>
<li>金融科技场景专用组件</li>
<li>主题系统和样式管理</li>
<li>与 Element UI 的集成适配</li>
</ul>
<p><strong>技术栈：</strong></p>
<ul>
<li>Vue 2.6+/2.7+ (支持 Composition API)</li>
<li>Element UI 2.15.x (UI 框架基础)</li>
<li>Sass/SCSS (样式预处理)</li>
<li>TypeScript (类型定义)</li>
</ul>
<h4 id="ms-lowcode-packages-lowcode-低代码平台"><a href="#ms-lowcode-packages-lowcode-低代码平台" class="headerlink" title="@ms/lowcode (packages/lowcode) - 低代码平台"></a>@ms/lowcode (packages/lowcode) - 低代码平台</h4><p><strong>职责范围：</strong></p>
<ul>
<li>Schema 驱动的组件生成引擎</li>
<li>AI 辅助的页面搭建</li>
<li>组件配置系统</li>
<li>代码生成和预览</li>
</ul>
<p><strong>技术栈：</strong></p>
<ul>
<li>JavaScript/TypeScript</li>
<li>Vue 2.x (运行时)</li>
<li>Python (AI 处理后端)</li>
</ul>
<h4 id="docs-文档系统"><a href="#docs-文档系统" class="headerlink" title="docs - 文档系统"></a>docs - 文档系统</h4><p><strong>职责范围：</strong></p>
<ul>
<li>组件使用文档</li>
<li>API 参考手册</li>
<li>示例代码展示</li>
<li>在线演示环境</li>
</ul>
<h4 id="examples-示例项目"><a href="#examples-示例项目" class="headerlink" title="examples - 示例项目"></a>examples - 示例项目</h4><p><strong>职责范围：</strong></p>
<ul>
<li>组件功能演示</li>
<li>集成案例展示</li>
<li>开发环境测试</li>
<li>用户学习引导</li>
</ul>
<h3 id="1-3-包间依赖关系设计"><a href="#1-3-包间依赖关系设计" class="headerlink" title="1.3 包间依赖关系设计"></a>1.3 包间依赖关系设计</h3><p>基于功能职责划分，我们建立了清晰的依赖层次：</p>
<pre class="mermaid">graph TD
    A[examples] --> B[@ms/ui]
    A --> C[docs]
    C --> B
    D[@ms/lowcode] --> B
    D --> E[AI Backend]</pre>

<p><strong>依赖策略：</strong></p>
<ul>
<li><code>examples</code> 依赖 <code>@ms/ui</code> 和 <code>docs</code>，用于演示和测试</li>
<li><code>docs</code> 依赖 <code>@ms/ui</code>，用于生成组件文档</li>
<li><code>@ms/lowcode</code> 依赖 <code>@ms/ui</code>，基于核心组件构建低代码功能</li>
<li>各包独立维护自己的构建和发布流程</li>
</ul>
<h2 id="二、pnpm-workspace-的工作原理与配置实践"><a href="#二、pnpm-workspace-的工作原理与配置实践" class="headerlink" title="二、pnpm workspace 的工作原理与配置实践"></a>二、pnpm workspace 的工作原理与配置实践</h2><h3 id="2-1-pnpm-workspace-核心机制"><a href="#2-1-pnpm-workspace-核心机制" class="headerlink" title="2.1 pnpm workspace 核心机制"></a>2.1 pnpm workspace 核心机制</h3><p>pnpm workspace 通过软链接实现包间的本地依赖，避免了传统的 npm link 方案的复杂性：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pnpm-workspace.yaml</span></span><br><span class="line"><span class="attr">packages:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">&quot;packages/*&quot;</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">&quot;docs&quot;</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">&quot;examples&quot;</span></span><br></pre></td></tr></table></figure>

<p><strong>工作原理：</strong></p>
<ol>
<li><strong>包发现</strong>：自动识别 workspace 中的所有包</li>
<li><strong>依赖解析</strong>：优先使用 workspace 内的本地包</li>
<li><strong>软链接创建</strong>：在 node_modules 中创建指向本地包的软链接</li>
<li><strong>版本同步</strong>：确保所有包使用相同的依赖版本</li>
</ol>
<h3 id="2-2-Workspace-配置的最佳实践"><a href="#2-2-Workspace-配置的最佳实践" class="headerlink" title="2.2 Workspace 配置的最佳实践"></a>2.2 Workspace 配置的最佳实践</h3><h4 id="包命名规范"><a href="#包命名规范" class="headerlink" title="包命名规范"></a>包命名规范</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// packages/core/package.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;@ms/ui&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MS UI System - 企业级金融科技UI设计系统&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// packages/lowcode/package.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;@ms/lowcode&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MS UI Lowcode Platform&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>命名规则：</strong></p>
<ul>
<li>使用 <code>@ms/</code> 作为命名空间前缀</li>
<li>包名简洁明了，体现功能职责</li>
<li>版本号在 workspace 内保持同步</li>
</ul>
<h4 id="本地依赖引用"><a href="#本地依赖引用" class="headerlink" title="本地依赖引用"></a>本地依赖引用</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// docs/package.json - 引用核心组件库</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;@ms/ui&quot;</span><span class="punctuation">:</span> <span class="string">&quot;workspace:*&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;vue&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.7.14&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// examples/package.json - 引用多个包</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;@ms/ui&quot;</span><span class="punctuation">:</span> <span class="string">&quot;workspace:*&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;vue&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.7.14&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>workspace:* 语义：</strong></p>
<ul>
<li><code>workspace:*</code> 表示使用 workspace 中的最新版本</li>
<li>自动解析为本地包的实际路径</li>
<li>支持热重载和实时更新</li>
</ul>
<h3 id="2-3-Workspace-的优势体现"><a href="#2-3-Workspace-的优势体现" class="headerlink" title="2.3 Workspace 的优势体现"></a>2.3 Workspace 的优势体现</h3><h4 id="依赖版本统一"><a href="#依赖版本统一" class="headerlink" title="依赖版本统一"></a>依赖版本统一</h4><p>在传统多包项目中，每个包可能安装不同版本的依赖：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 传统方式 - 版本不一致问题</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;packages&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;core&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> <span class="attr">&quot;vue&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.6.14&quot;</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;docs&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> <span class="attr">&quot;vue&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.7.14&quot;</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;examples&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> <span class="attr">&quot;vue&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.6.14&quot;</span> <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>workspace 确保版本统一：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// workspace 方式 - 版本统一</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;vue&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.7.14&quot;</span> <span class="comment">// 所有包共享相同版本</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="磁盘空间节省"><a href="#磁盘空间节省" class="headerlink" title="磁盘空间节省"></a>磁盘空间节省</h4><p><strong>传统方式：</strong></p>
<ul>
<li>每个包独立安装 node_modules</li>
<li>重复依赖占用大量磁盘空间</li>
<li>packages/core: 150MB</li>
<li>packages/docs: 120MB</li>
<li>packages/examples: 130MB</li>
<li><strong>总计：400MB</strong></li>
</ul>
<p><strong>workspace 方式：</strong></p>
<ul>
<li>共享 node_modules</li>
<li>通过软链接复用依赖</li>
<li>packages/core: 150MB</li>
<li>docs/examples: &lt; 1MB (软链接)</li>
<li><strong>总计：~151MB</strong></li>
</ul>
<h4 id="开发效率提升"><a href="#开发效率提升" class="headerlink" title="开发效率提升"></a>开发效率提升</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 传统方式 - 需要分别安装和构建</span></span><br><span class="line"><span class="built_in">cd</span> packages/core &amp;&amp; npm install</span><br><span class="line"><span class="built_in">cd</span> ../docs &amp;&amp; npm install</span><br><span class="line"><span class="built_in">cd</span> ../examples &amp;&amp; npm install</span><br><span class="line"></span><br><span class="line"><span class="comment"># workspace 方式 - 统一管理</span></span><br><span class="line">pnpm install  <span class="comment"># 一次安装所有包的依赖</span></span><br><span class="line">pnpm build    <span class="comment"># 并行构建所有包</span></span><br></pre></td></tr></table></figure>

<h2 id="三、依赖管理、版本控制与发布策略"><a href="#三、依赖管理、版本控制与发布策略" class="headerlink" title="三、依赖管理、版本控制与发布策略"></a>三、依赖管理、版本控制与发布策略</h2><h3 id="3-1-依赖管理策略"><a href="#3-1-依赖管理策略" class="headerlink" title="3.1 依赖管理策略"></a>3.1 依赖管理策略</h3><h4 id="生产依赖-vs-对等依赖"><a href="#生产依赖-vs-对等依赖" class="headerlink" title="生产依赖 vs 对等依赖"></a>生产依赖 vs 对等依赖</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// packages/core/package.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// 核心运行时依赖</span></span><br><span class="line">    <span class="attr">&quot;vue&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.6.14&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;peerDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// 宿主项目需提供的依赖</span></span><br><span class="line">    <span class="attr">&quot;element-ui&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.15.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;vue&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.6.0 || ^2.7.0&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;peerDependenciesMeta&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// 可选的对等依赖</span></span><br><span class="line">    <span class="attr">&quot;@vue/composition-api&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;optional&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>设计考量：</strong></p>
<ul>
<li><strong>生产依赖</strong>：组件库运行必需的依赖</li>
<li><strong>对等依赖</strong>：避免版本冲突，交由宿主项目管理</li>
<li><strong>可选依赖</strong>：在特定条件下才需要的依赖</li>
</ul>
<h4 id="依赖版本锁定"><a href="#依赖版本锁定" class="headerlink" title="依赖版本锁定"></a>依赖版本锁定</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 根目录 package.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;overrides&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;@vue/composition-api&quot;</span><span class="punctuation">:</span> <span class="string">&quot;npm:vue@^2.7.0&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;resolutions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;@vue/composition-api&quot;</span><span class="punctuation">:</span> <span class="string">&quot;npm:vue@^2.7.0&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>锁定机制：</strong></p>
<ul>
<li><code>overrides</code>: npm 8.3+ 支持，强制替换依赖</li>
<li><code>resolutions</code>: pnpm/yarn 支持的通用方案</li>
<li>确保 Vue 2.7+ 项目不安装多余的 @vue/composition-api</li>
</ul>
<h3 id="3-2-版本控制策略"><a href="#3-2-版本控制策略" class="headerlink" title="3.2 版本控制策略"></a>3.2 版本控制策略</h3><h4 id="统一版本管理"><a href="#统一版本管理" class="headerlink" title="统一版本管理"></a>统一版本管理</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// scripts/reset-version.js - 版本重置脚本</span></span><br><span class="line">const fs = require(&#x27;fs&#x27;);</span><br><span class="line">const path = require(&#x27;path&#x27;);</span><br><span class="line"></span><br><span class="line">const packages = <span class="punctuation">[</span>&#x27;packages/core&#x27;<span class="punctuation">,</span> &#x27;packages/lowcode&#x27;<span class="punctuation">]</span>;</span><br><span class="line">const version = require(&#x27;../package.json&#x27;).version;</span><br><span class="line"></span><br><span class="line">packages.forEach(pkg =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">  const pkgPath = path.join(__dirname<span class="punctuation">,</span> &#x27;..&#x27;<span class="punctuation">,</span> pkg<span class="punctuation">,</span> &#x27;package.json&#x27;);</span><br><span class="line">  if (fs.existsSync(pkgPath)) <span class="punctuation">&#123;</span></span><br><span class="line">    const pkgJson = JSON.parse(fs.readFileSync(pkgPath<span class="punctuation">,</span> &#x27;utf8&#x27;));</span><br><span class="line">    pkgJson.version = version;</span><br><span class="line">    fs.writeFileSync(pkgPath<span class="punctuation">,</span> JSON.stringify(pkgJson<span class="punctuation">,</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span> <span class="number">2</span>));</span><br><span class="line">    console.log(`✓ Updated $<span class="punctuation">&#123;</span>pkg<span class="punctuation">&#125;</span> to version $<span class="punctuation">&#123;</span>version<span class="punctuation">&#125;</span>`);</span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="发布流程自动化"><a href="#发布流程自动化" class="headerlink" title="发布流程自动化"></a>发布流程自动化</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># scripts/publish.sh - 发布脚本</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 版本检查</span></span><br><span class="line">current_version=$(node -p <span class="string">&quot;require(&#x27;./package.json&#x27;).version&quot;</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Publishing version: <span class="variable">$current_version</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 构建所有包</span></span><br><span class="line">pnpm run build</span><br><span class="line"></span><br><span class="line"><span class="comment"># 发布核心包</span></span><br><span class="line"><span class="built_in">cd</span> packages/core</span><br><span class="line">npm publish --access restricted</span><br><span class="line"><span class="built_in">cd</span> ../..</span><br><span class="line"></span><br><span class="line"><span class="comment"># 记录发布日志</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="subst">$(date)</span>: Published version <span class="variable">$current_version</span>&quot;</span> &gt;&gt; .publish-log</span><br></pre></td></tr></table></figure>

<h3 id="3-3-发布策略设计"><a href="#3-3-发布策略设计" class="headerlink" title="3.3 发布策略设计"></a>3.3 发布策略设计</h3><h4 id="分级发布策略"><a href="#分级发布策略" class="headerlink" title="分级发布策略"></a>分级发布策略</h4><p><strong>Lerna 风格的发布：</strong></p>
<ul>
<li><strong>固定版本</strong>：所有包使用相同版本号</li>
<li><strong>独立版本</strong>：各包可独立发布新版本</li>
<li><strong>混合策略</strong>：核心包固定版本，工具包独立版本</li>
</ul>
<p>MS UI System 采用<strong>固定版本策略</strong>：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 根目录版本控制</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ms-ui-system&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 子包版本同步</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;@ms/ui&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span>  <span class="comment">// 与根目录版本保持一致</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>优势：</strong></p>
<ul>
<li>版本号统一管理</li>
<li>发布流程简化</li>
<li>用户理解成本低</li>
</ul>
<h4 id="发布渠道设计"><a href="#发布渠道设计" class="headerlink" title="发布渠道设计"></a>发布渠道设计</h4><p><strong>私有 npm 仓库：</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// packages/core/package.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;publishConfig&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;registry&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://&#123;打码&#125;/artifactory/&#123;打码&#125;-npm-release-local/&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;access&quot;</span><span class="punctuation">:</span> <span class="string">&quot;restricted&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>多渠道发布：</strong></p>
<ul>
<li><strong>内网仓库</strong>：企业内部使用</li>
<li><strong>CDN 资源</strong>：静态资源分发</li>
<li><strong>GitHub Release</strong>：开源版本发布</li>
</ul>
<h2 id="四、跨包代码共享与构建优化"><a href="#四、跨包代码共享与构建优化" class="headerlink" title="四、跨包代码共享与构建优化"></a>四、跨包代码共享与构建优化</h2><h3 id="4-1-代码共享机制"><a href="#4-1-代码共享机制" class="headerlink" title="4.1 代码共享机制"></a>4.1 代码共享机制</h3><h4 id="工具函数共享"><a href="#工具函数共享" class="headerlink" title="工具函数共享"></a>工具函数共享</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// packages/core/src/utils/index.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">formatCurrency</span> = (<span class="params">value, currency = <span class="string">&quot;CNY&quot;</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 货币格式化逻辑</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">validateIdCard</span> = (<span class="params">id</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 身份证验证逻辑</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// packages/lowcode/src/utils/validation.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; validateIdCard &#125; <span class="keyword">from</span> <span class="string">&quot;@ms/ui/src/utils&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 复用核心包的验证函数</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">validateUser</span> = (<span class="params">user</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">validateIdCard</span>(user.<span class="property">idCard</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="类型定义共享"><a href="#类型定义共享" class="headerlink" title="类型定义共享"></a>类型定义共享</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// packages/core/src/types/index.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">ComponentProps</span> &#123;</span><br><span class="line">  <span class="attr">theme</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">size</span>?: <span class="string">&quot;small&quot;</span> | <span class="string">&quot;medium&quot;</span> | <span class="string">&quot;large&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// packages/lowcode/src/types/schema.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ComponentProps</span> &#125; <span class="keyword">from</span> <span class="string">&quot;@ms/ui/src/types&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">SchemaNode</span> <span class="keyword">extends</span> <span class="title class_">ComponentProps</span> &#123;</span><br><span class="line">  <span class="attr">component</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">props</span>: <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">any</span>&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-2-构建优化策略"><a href="#4-2-构建优化策略" class="headerlink" title="4.2 构建优化策略"></a>4.2 构建优化策略</h3><h4 id="并行构建优化"><a href="#并行构建优化" class="headerlink" title="并行构建优化"></a>并行构建优化</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// scripts/build-advanced.js - 并行构建实现</span></span><br><span class="line"><span class="keyword">const</span> &#123; execSync &#125; = <span class="built_in">require</span>(<span class="string">&quot;child_process&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">buildPackages</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> packages = [<span class="string">&quot;core&quot;</span>, <span class="string">&quot;lowcode&quot;</span>, <span class="string">&quot;docs&quot;</span>];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 并行构建所有包</span></span><br><span class="line">  <span class="keyword">const</span> buildPromises = packages.<span class="title function_">map</span>(<span class="function">(<span class="params">pkg</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Building <span class="subst">$&#123;pkg&#125;</span>...`</span>);</span><br><span class="line">        <span class="title function_">execSync</span>(<span class="string">`cd packages/<span class="subst">$&#123;pkg&#125;</span> &amp;&amp; npm run build`</span>, &#123; <span class="attr">stdio</span>: <span class="string">&quot;inherit&quot;</span> &#125;);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`✓ <span class="subst">$&#123;pkg&#125;</span> built successfully`</span>);</span><br><span class="line">        <span class="title function_">resolve</span>();</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`✗ <span class="subst">$&#123;pkg&#125;</span> build failed`</span>);</span><br><span class="line">        <span class="title function_">reject</span>(error);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>(buildPromises);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="增量构建支持"><a href="#增量构建支持" class="headerlink" title="增量构建支持"></a>增量构建支持</h4><p><strong>基于文件变化的智能构建：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 检测文件变化</span></span><br><span class="line"><span class="keyword">const</span> changedFiles = <span class="title function_">getChangedFiles</span>();</span><br><span class="line"><span class="keyword">const</span> affectedPackages = <span class="title function_">getAffectedPackages</span>(changedFiles);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 只构建受影响的包</span></span><br><span class="line">affectedPackages.<span class="title function_">forEach</span>(<span class="function">(<span class="params">pkg</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">buildPackage</span>(pkg);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="输出产物优化"><a href="#输出产物优化" class="headerlink" title="输出产物优化"></a>输出产物优化</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack 配置优化</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="comment">// 多入口构建</span></span><br><span class="line">    <span class="attr">filename</span>: <span class="function">(<span class="params">chunkData</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> chunkData.<span class="property">chunk</span>.<span class="property">name</span> === <span class="string">&quot;core&quot;</span></span><br><span class="line">        ? <span class="string">&quot;ms-ui-system.js&quot;</span></span><br><span class="line">        : <span class="string">&quot;ms-ui-system.esm.js&quot;</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">library</span>: &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;MsUI&quot;</span>,</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&quot;umd&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">optimization</span>: &#123;</span><br><span class="line">    <span class="comment">// 代码分割</span></span><br><span class="line">    <span class="attr">splitChunks</span>: &#123;</span><br><span class="line">      <span class="attr">chunks</span>: <span class="string">&quot;all&quot;</span>,</span><br><span class="line">      <span class="attr">cacheGroups</span>: &#123;</span><br><span class="line">        <span class="attr">vendor</span>: &#123;</span><br><span class="line">          <span class="attr">test</span>: <span class="regexp">/[\\/]node_modules[\\/]/</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&quot;vendors&quot;</span>,</span><br><span class="line">          <span class="attr">chunks</span>: <span class="string">&quot;all&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="五、实践经验与最佳实践"><a href="#五、实践经验与最佳实践" class="headerlink" title="五、实践经验与最佳实践"></a>五、实践经验与最佳实践</h2><h3 id="5-1-包结构设计的经验总结"><a href="#5-1-包结构设计的经验总结" class="headerlink" title="5.1 包结构设计的经验总结"></a>5.1 包结构设计的经验总结</h3><h4 id="职责分离原则"><a href="#职责分离原则" class="headerlink" title="职责分离原则"></a>职责分离原则</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ✅ 好的包结构</span></span><br><span class="line">packages/</span><br><span class="line">├── core/          # 纯组件库</span><br><span class="line">├── lowcode/       # <span class="variable constant_">AI</span>低代码功能</span><br><span class="line">├── docs/          # 文档工具</span><br><span class="line">└── examples/      # 演示代码</span><br><span class="line"></span><br><span class="line"><span class="comment">// ❌ 不好的包结构</span></span><br><span class="line">packages/</span><br><span class="line">├── ui-core/       # 组件库</span><br><span class="line">├── ui-docs/       # 文档 (应该独立)</span><br><span class="line">├── ui-examples/   # 示例 (应该独立)</span><br><span class="line">└── ui-utils/      # 工具 (应该合并到core)</span><br></pre></td></tr></table></figure>

<h4 id="包大小控制"><a href="#包大小控制" class="headerlink" title="包大小控制"></a>包大小控制</h4><p><strong>包体积监控：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检查包大小</span></span><br><span class="line"><span class="built_in">du</span> -sh packages/*/lib/</span><br><span class="line"><span class="comment"># core: 2.3M</span></span><br><span class="line"><span class="comment"># lowcode: 850K</span></span><br><span class="line"><span class="comment"># docs: 1.1M</span></span><br></pre></td></tr></table></figure>

<p><strong>体积优化策略：</strong></p>
<ul>
<li>按需引入支持</li>
<li>Tree Shaking 优化</li>
<li>代码分割和懒加载</li>
</ul>
<h3 id="5-2-依赖管理的最佳实践"><a href="#5-2-依赖管理的最佳实践" class="headerlink" title="5.2 依赖管理的最佳实践"></a>5.2 依赖管理的最佳实践</h3><h4 id="依赖版本策略"><a href="#依赖版本策略" class="headerlink" title="依赖版本策略"></a>依赖版本策略</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 推荐的版本范围设置</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// 核心依赖使用精确版本</span></span><br><span class="line">    <span class="attr">&quot;vue&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2.7.14&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;peerDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// 对等依赖使用范围版本</span></span><br><span class="line">    <span class="attr">&quot;element-ui&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.15.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;vue&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.6.0 || ^2.7.0&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="循环依赖避免"><a href="#循环依赖避免" class="headerlink" title="循环依赖避免"></a>循环依赖避免</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ❌ 循环依赖 (避免)</span></span><br><span class="line">core -&gt; lowcode</span><br><span class="line">lowcode -&gt; core</span><br><span class="line"></span><br><span class="line"><span class="comment">// ✅ 正确的依赖方向</span></span><br><span class="line">lowcode -&gt; core</span><br><span class="line">docs -&gt; core</span><br><span class="line">examples -&gt; core</span><br></pre></td></tr></table></figure>

<h3 id="5-3-发布流程的持续优化"><a href="#5-3-发布流程的持续优化" class="headerlink" title="5.3 发布流程的持续优化"></a>5.3 发布流程的持续优化</h3><h4 id="自动化发布流水线"><a href="#自动化发布流水线" class="headerlink" title="自动化发布流水线"></a>自动化发布流水线</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .github/workflows/publish.yml</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">Publish</span> <span class="string">Packages</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">tags:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;v*&quot;</span></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">publish:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/setup-node@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">node-version:</span> <span class="string">&quot;16&quot;</span></span><br><span class="line">          <span class="attr">registry-url:</span> <span class="string">&quot;https://registry.npmjs.org/&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">run:</span> <span class="string">pnpm</span> <span class="string">install</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">run:</span> <span class="string">pnpm</span> <span class="string">build</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">run:</span> <span class="string">pnpm</span> <span class="string">publish:all</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">          <span class="attr">NODE_AUTH_TOKEN:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.NPM_TOKEN</span> <span class="string">&#125;&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="发布前检查清单"><a href="#发布前检查清单" class="headerlink" title="发布前检查清单"></a>发布前检查清单</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># pre-publish-check.sh</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;🔍 发布前检查...&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 版本一致性检查</span></span><br><span class="line"><span class="function"><span class="title">check_versions</span></span>() &#123;</span><br><span class="line">  root_version=$(node -p <span class="string">&quot;require(&#x27;./package.json&#x27;).version&quot;</span>)</span><br><span class="line">  core_version=$(node -p <span class="string">&quot;require(&#x27;./packages/core/package.json&#x27;).version&quot;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$root_version</span>&quot;</span> != <span class="string">&quot;<span class="variable">$core_version</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;❌ 版本不一致: 根目录(<span class="variable">$root_version</span>) vs 核心包(<span class="variable">$core_version</span>)&quot;</span></span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;✓ 版本一致性检查通过&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 构建产物检查</span></span><br><span class="line"><span class="function"><span class="title">check_build</span></span>() &#123;</span><br><span class="line">  <span class="keyword">if</span> [ ! -d <span class="string">&quot;packages/core/lib&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;❌ 构建产物不存在，请先执行构建&quot;</span></span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;✓ 构建产物检查通过&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 测试检查</span></span><br><span class="line"><span class="function"><span class="title">run_tests</span></span>() &#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;🧪 运行测试...&quot;</span></span><br><span class="line">  pnpm <span class="built_in">test</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;✓ 测试通过&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">check_versions</span><br><span class="line">check_build</span><br><span class="line">run_tests</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;🎉 发布前检查全部通过！&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="六、总结与展望"><a href="#六、总结与展望" class="headerlink" title="六、总结与展望"></a>六、总结与展望</h2><p>MS UI System 通过 pnpm workspace 成功构建了现代化的 Monorepo 架构，在大型组件库的包管理、依赖控制和构建优化方面积累了宝贵经验。</p>
<p><strong>核心优势体现：</strong></p>
<ol>
<li><strong>开发效率提升</strong>：统一的依赖管理和并行构建</li>
<li><strong>版本一致性保障</strong>：workspace 内的版本统一管理</li>
<li><strong>资源利用优化</strong>：磁盘空间节省和构建时间减少</li>
<li><strong>维护成本降低</strong>：集中式的包管理和发布流程</li>
</ol>
<p><strong>未来优化方向：</strong></p>
<ol>
<li><strong>更细粒度的包拆分</strong>：考虑将核心组件进一步拆分为独立的子包</li>
<li><strong>智能构建系统</strong>：基于依赖关系图的增量构建优化</li>
<li><strong>发布策略升级</strong>：支持包级别的独立发布和版本管理</li>
<li><strong>性能监控体系</strong>：建立包大小和构建时间的监控指标</li>
</ol>
<h2 id="六、当前实现状态与优化评估"><a href="#六、当前实现状态与优化评估" class="headerlink" title="六、当前实现状态与优化评估"></a>六、当前实现状态与优化评估</h2><h3 id="6-1-已实现的功能"><a href="#6-1-已实现的功能" class="headerlink" title="6.1 已实现的功能"></a>6.1 已实现的功能</h3><h4 id="✅-基础的多包架构"><a href="#✅-基础的多包架构" class="headerlink" title="✅ 基础的多包架构"></a>✅ 基础的多包架构</h4><ul>
<li><strong>pnpm workspace 配置</strong>：已正确配置工作空间，支持多个包的统一管理</li>
<li><strong>包依赖关系</strong>：lowcode 包正确依赖 @ms/ui 核心包</li>
<li><strong>独立的包构建</strong>：每个包都有独立的构建脚本和配置</li>
</ul>
<h4 id="✅-基础的构建系统"><a href="#✅-基础的构建系统" class="headerlink" title="✅ 基础的构建系统"></a>✅ 基础的构建系统</h4><ul>
<li><strong>多格式输出</strong>：支持 UMD 和 ESM 两种格式的构建产物</li>
<li><strong>Webpack 配置分离</strong>：不同场景使用不同的 webpack 配置</li>
<li><strong>CSS 提取和优化</strong>：使用 MiniCssExtractPlugin 进行样式分离</li>
</ul>
<h4 id="✅-发布和分发"><a href="#✅-发布和分发" class="headerlink" title="✅ 发布和分发"></a>✅ 发布和分发</h4><ul>
<li><strong>企业内网仓库</strong>：配置了内部 npm 仓库用于发布</li>
<li><strong>版本管理</strong>：有完整的版本管理脚本和发布流程</li>
</ul>
<h3 id="6-2-未实现的优化"><a href="#6-2-未实现的优化" class="headerlink" title="6.2 未实现的优化"></a>6.2 未实现的优化</h3><h4 id="🚫-跨包代码共享机制"><a href="#🚫-跨包代码共享机制" class="headerlink" title="🚫 跨包代码共享机制"></a>🚫 跨包代码共享机制</h4><p><strong>状态</strong>：理论设计，未实际实现</p>
<p><strong>缺失内容：</strong></p>
<ul>
<li><code>packages/core/src/utils/index.js</code> 中的共享工具函数（<code>formatCurrency</code>、<code>validateIdCard</code>）</li>
<li><code>packages/core/src/types/index.ts</code> 中的共享类型定义</li>
<li>跨包的工具函数复用机制</li>
</ul>
<p><strong>影响</strong>：各包重复实现相同的工具函数，增加了维护成本</p>
<h4 id="🚫-基于文件变化的智能构建"><a href="#🚫-基于文件变化的智能构建" class="headerlink" title="🚫 基于文件变化的智能构建"></a>🚫 基于文件变化的智能构建</h4><p><strong>状态</strong>：理论设计，未实际实现</p>
<p><strong>缺失内容：</strong></p>
<ul>
<li><code>getChangedFiles()</code> 函数实现</li>
<li><code>getAffectedPackages()</code> 函数实现</li>
<li>基于依赖关系图的增量构建逻辑</li>
</ul>
<p><strong>影响</strong>：每次构建都需要重新构建所有包，构建时间较长</p>
<h4 id="🚫-并行构建优化"><a href="#🚫-并行构建优化" class="headerlink" title="🚫 并行构建优化"></a>🚫 并行构建优化</h4><p><strong>状态</strong>：理论设计，未实际实现</p>
<p><strong>缺失内容：</strong></p>
<ul>
<li><code>buildPackages()</code> 并行构建函数</li>
<li>多包并发构建的 Promise.all 实现</li>
<li>构建状态管理和错误处理</li>
</ul>
<p><strong>影响</strong>：包的构建是串行的，无法充分利用多核 CPU</p>
<h4 id="🚫-输出产物高级优化"><a href="#🚫-输出产物高级优化" class="headerlink" title="🚫 输出产物高级优化"></a>🚫 输出产物高级优化</h4><p><strong>状态</strong>：部分实现，缺少代码分割和按需引入</p>
<p><strong>缺失内容：</strong></p>
<ul>
<li>webpack <code>optimization.splitChunks</code> 配置</li>
<li>基于使用频率的智能代码分割</li>
<li>按需加载和懒加载支持</li>
<li>Tree Shaking 优化配置</li>
<li>多入口构建支持（es/ 目录结构）</li>
<li>按需引入的单独组件构建</li>
</ul>
<p><strong>影响</strong>：构建产物较大，用户无法按需加载，只能全量引入所有组件</p>
<h4 id="🚫-多渠道发布策略"><a href="#🚫-多渠道发布策略" class="headerlink" title="🚫 多渠道发布策略"></a>🚫 多渠道发布策略</h4><p><strong>状态</strong>：部分实现，仅支持内网仓库</p>
<p><strong>缺失内容：</strong></p>
<ul>
<li><strong>CDN 资源分发</strong>：没有自动上传到 CDN 的脚本和流程</li>
<li><strong>GitHub Release</strong>：没有自动创建 GitHub Release 的 CI/CD 配置</li>
<li><strong>多渠道同步发布</strong>：无法同时发布到多个仓库</li>
</ul>
<p><strong>影响</strong>：发布流程单一，只能在企业内网使用，无法支持开源场景</p>
<h4 id="🚫-包大小和构建性能监控"><a href="#🚫-包大小和构建性能监控" class="headerlink" title="🚫 包大小和构建性能监控"></a>🚫 包大小和构建性能监控</h4><p><strong>状态</strong>：理论设计，完全未实现</p>
<p><strong>缺失内容：</strong></p>
<ul>
<li>包大小监控脚本（<code>du -sh packages/*/lib/</code>）</li>
<li>构建时间自动记录和对比</li>
<li>包体积趋势分析</li>
<li>构建性能指标收集</li>
<li>监控告警机制</li>
</ul>
<p><strong>影响</strong>：无法及时发现包体积增长和构建性能问题</p>
<h4 id="🚫-CI-CD-自动化流水线"><a href="#🚫-CI-CD-自动化流水线" class="headerlink" title="🚫 CI/CD 自动化流水线"></a>🚫 CI/CD 自动化流水线</h4><p><strong>状态</strong>：完全未实现</p>
<p><strong>缺失内容：</strong></p>
<ul>
<li><strong>GitHub Actions 配置</strong>：没有 <code>.github/workflows/</code> 目录</li>
<li><strong>自动化测试流水线</strong>：构建前后的自动化测试</li>
<li><strong>自动化发布流程</strong>：版本自动打标和发布</li>
<li><strong>质量门禁</strong>：代码规范检查、测试覆盖率要求</li>
<li><strong>多环境部署</strong>：开发、测试、生产环境的自动部署</li>
</ul>
<p><strong>影响</strong>：发布流程完全依赖人工操作，无法保证发布质量和频率</p>
<h4 id="🚫-依赖关系图分析"><a href="#🚫-依赖关系图分析" class="headerlink" title="🚫 依赖关系图分析"></a>🚫 依赖关系图分析</h4><p><strong>状态</strong>：理论设计，未实现</p>
<p><strong>缺失内容：</strong></p>
<ul>
<li><strong>包依赖可视化</strong>：依赖关系图生成工具</li>
<li><strong>循环依赖检测</strong>：自动发现和警告循环依赖</li>
<li><strong>影响范围分析</strong>：修改一个包时自动计算受影响的其他包</li>
<li><strong>包大小依赖分析</strong>：分析各包的依赖对最终包大小的影响</li>
</ul>
<p><strong>影响</strong>：难以理解包之间的复杂关系，增加了维护难度</p>
<h3 id="6-3-当前构建流程的实际情况"><a href="#6-3-当前构建流程的实际情况" class="headerlink" title="6.3 当前构建流程的实际情况"></a>6.3 当前构建流程的实际情况</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 当前的构建方式（串行执行）</span></span><br><span class="line">npm run <span class="attr">build</span>:lib    <span class="comment">// 构建 UMD 格式</span></span><br><span class="line">npm run <span class="attr">build</span>:esm    <span class="comment">// 构建 ESM 格式</span></span><br><span class="line">npm run <span class="attr">build</span>:components <span class="comment">// 构建组件</span></span><br></pre></td></tr></table></figure>

<p><strong>构建时间评估</strong>：全量构建需要 2-3 分钟（视机器性能而定）</p>
<p><strong>包大小现状</strong>：</p>
<ul>
<li>core 包：约 2.3MB（包含所有组件和样式）</li>
<li>lowcode 包：约 850KB（核心引擎）</li>
<li>docs 包：约 1.1MB（文档系统）</li>
</ul>
<h3 id="6-4-技术债务与改进建议"><a href="#6-4-技术债务与改进建议" class="headerlink" title="6.4 技术债务与改进建议"></a>6.4 技术债务与改进建议</h3><h4 id="短期改进（1-2-周内可完成）"><a href="#短期改进（1-2-周内可完成）" class="headerlink" title="短期改进（1-2 周内可完成）"></a>短期改进（1-2 周内可完成）</h4><ol>
<li><p><strong>实现基础的工具函数共享</strong></p>
<ul>
<li>在 core 包中创建 <code>src/utils/index.js</code></li>
<li>导出通用的格式化函数和验证函数</li>
<li>更新 lowcode 包的引用</li>
</ul>
</li>
<li><p><strong>添加基本的并行构建</strong></p>
<ul>
<li>修改根目录的构建脚本</li>
<li>使用 <code>concurrently</code> 或原生 Promise.all</li>
<li>实现简单的多包并发构建</li>
</ul>
</li>
</ol>
<h4 id="中期改进（1-个月内）"><a href="#中期改进（1-个月内）" class="headerlink" title="中期改进（1 个月内）"></a>中期改进（1 个月内）</h4><ol>
<li><p><strong>引入智能构建工具</strong></p>
<ul>
<li>评估并引入 <code>nx</code> 或 <code>lerna</code> 的增量构建功能</li>
<li>实现基于文件变化的构建优化</li>
<li>添加构建缓存机制</li>
</ul>
</li>
<li><p><strong>完善代码分割策略</strong></p>
<ul>
<li>在 webpack 配置中添加 <code>splitChunks</code> 配置</li>
<li>按组件类别进行代码分割</li>
<li>实现按需加载机制</li>
</ul>
</li>
</ol>
<h4 id="长期规划（3-个月-）"><a href="#长期规划（3-个月-）" class="headerlink" title="长期规划（3 个月+）"></a>长期规划（3 个月+）</h4><ol>
<li><p><strong>构建性能监控</strong></p>
<ul>
<li>建立构建时间和包大小的监控指标</li>
<li>实施持续的性能优化措施</li>
</ul>
</li>
<li><p><strong>架构演进</strong></p>
<ul>
<li>考虑更细粒度的包拆分策略</li>
<li>探索微前端架构的可能性</li>
</ul>
</li>
</ol>
<p>MS UI System 的 Monorepo 架构将参考和借鉴更多企业级前端项目，来进行持续的架构优化和最佳实践积累。</p>
<hr>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="https://github.com/apriljii">Projects</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E7%BB%84%E4%BB%B6%E5%BA%93%E7%9A%84%E5%8C%85%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E8%81%8C%E8%B4%A3%E5%88%92%E5%88%86"><span class="toc-number">2.</span> <span class="toc-text">一、组件库的包结构设计与职责划分</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88"><span class="toc-number">2.1.</span> <span class="toc-text">1.1 整体架构概览</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E5%8C%85%E8%81%8C%E8%B4%A3%E6%98%8E%E7%A1%AE%E5%88%92%E5%88%86"><span class="toc-number">2.2.</span> <span class="toc-text">1.2 包职责明确划分</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ms-ui-packages-core-%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6%E5%BA%93"><span class="toc-number">2.2.1.</span> <span class="toc-text">@ms&#x2F;ui (packages&#x2F;core) - 核心组件库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ms-lowcode-packages-lowcode-%E4%BD%8E%E4%BB%A3%E7%A0%81%E5%B9%B3%E5%8F%B0"><span class="toc-number">2.2.2.</span> <span class="toc-text">@ms&#x2F;lowcode (packages&#x2F;lowcode) - 低代码平台</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#docs-%E6%96%87%E6%A1%A3%E7%B3%BB%E7%BB%9F"><span class="toc-number">2.2.3.</span> <span class="toc-text">docs - 文档系统</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#examples-%E7%A4%BA%E4%BE%8B%E9%A1%B9%E7%9B%AE"><span class="toc-number">2.2.4.</span> <span class="toc-text">examples - 示例项目</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E5%8C%85%E9%97%B4%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB%E8%AE%BE%E8%AE%A1"><span class="toc-number">2.3.</span> <span class="toc-text">1.3 包间依赖关系设计</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81pnpm-workspace-%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%E4%B8%8E%E9%85%8D%E7%BD%AE%E5%AE%9E%E8%B7%B5"><span class="toc-number">3.</span> <span class="toc-text">二、pnpm workspace 的工作原理与配置实践</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-pnpm-workspace-%E6%A0%B8%E5%BF%83%E6%9C%BA%E5%88%B6"><span class="toc-number">3.1.</span> <span class="toc-text">2.1 pnpm workspace 核心机制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-Workspace-%E9%85%8D%E7%BD%AE%E7%9A%84%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">3.2.</span> <span class="toc-text">2.2 Workspace 配置的最佳实践</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%85%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83"><span class="toc-number">3.2.1.</span> <span class="toc-text">包命名规范</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E4%BE%9D%E8%B5%96%E5%BC%95%E7%94%A8"><span class="toc-number">3.2.2.</span> <span class="toc-text">本地依赖引用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-Workspace-%E7%9A%84%E4%BC%98%E5%8A%BF%E4%BD%93%E7%8E%B0"><span class="toc-number">3.3.</span> <span class="toc-text">2.3 Workspace 的优势体现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%9D%E8%B5%96%E7%89%88%E6%9C%AC%E7%BB%9F%E4%B8%80"><span class="toc-number">3.3.1.</span> <span class="toc-text">依赖版本统一</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A3%81%E7%9B%98%E7%A9%BA%E9%97%B4%E8%8A%82%E7%9C%81"><span class="toc-number">3.3.2.</span> <span class="toc-text">磁盘空间节省</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E6%95%88%E7%8E%87%E6%8F%90%E5%8D%87"><span class="toc-number">3.3.3.</span> <span class="toc-text">开发效率提升</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E3%80%81%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E4%B8%8E%E5%8F%91%E5%B8%83%E7%AD%96%E7%95%A5"><span class="toc-number">4.</span> <span class="toc-text">三、依赖管理、版本控制与发布策略</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E7%AD%96%E7%95%A5"><span class="toc-number">4.1.</span> <span class="toc-text">3.1 依赖管理策略</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%9F%E4%BA%A7%E4%BE%9D%E8%B5%96-vs-%E5%AF%B9%E7%AD%89%E4%BE%9D%E8%B5%96"><span class="toc-number">4.1.1.</span> <span class="toc-text">生产依赖 vs 对等依赖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%9D%E8%B5%96%E7%89%88%E6%9C%AC%E9%94%81%E5%AE%9A"><span class="toc-number">4.1.2.</span> <span class="toc-text">依赖版本锁定</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E7%AD%96%E7%95%A5"><span class="toc-number">4.2.</span> <span class="toc-text">3.2 版本控制策略</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%9F%E4%B8%80%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86"><span class="toc-number">4.2.1.</span> <span class="toc-text">统一版本管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%91%E5%B8%83%E6%B5%81%E7%A8%8B%E8%87%AA%E5%8A%A8%E5%8C%96"><span class="toc-number">4.2.2.</span> <span class="toc-text">发布流程自动化</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E5%8F%91%E5%B8%83%E7%AD%96%E7%95%A5%E8%AE%BE%E8%AE%A1"><span class="toc-number">4.3.</span> <span class="toc-text">3.3 发布策略设计</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%BA%A7%E5%8F%91%E5%B8%83%E7%AD%96%E7%95%A5"><span class="toc-number">4.3.1.</span> <span class="toc-text">分级发布策略</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%91%E5%B8%83%E6%B8%A0%E9%81%93%E8%AE%BE%E8%AE%A1"><span class="toc-number">4.3.2.</span> <span class="toc-text">发布渠道设计</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E8%B7%A8%E5%8C%85%E4%BB%A3%E7%A0%81%E5%85%B1%E4%BA%AB%E4%B8%8E%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96"><span class="toc-number">5.</span> <span class="toc-text">四、跨包代码共享与构建优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E4%BB%A3%E7%A0%81%E5%85%B1%E4%BA%AB%E6%9C%BA%E5%88%B6"><span class="toc-number">5.1.</span> <span class="toc-text">4.1 代码共享机制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7%E5%87%BD%E6%95%B0%E5%85%B1%E4%BA%AB"><span class="toc-number">5.1.1.</span> <span class="toc-text">工具函数共享</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89%E5%85%B1%E4%BA%AB"><span class="toc-number">5.1.2.</span> <span class="toc-text">类型定义共享</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96%E7%AD%96%E7%95%A5"><span class="toc-number">5.2.</span> <span class="toc-text">4.2 构建优化策略</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B9%B6%E8%A1%8C%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96"><span class="toc-number">5.2.1.</span> <span class="toc-text">并行构建优化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A2%9E%E9%87%8F%E6%9E%84%E5%BB%BA%E6%94%AF%E6%8C%81"><span class="toc-number">5.2.2.</span> <span class="toc-text">增量构建支持</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%87%BA%E4%BA%A7%E7%89%A9%E4%BC%98%E5%8C%96"><span class="toc-number">5.2.3.</span> <span class="toc-text">输出产物优化</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E5%AE%9E%E8%B7%B5%E7%BB%8F%E9%AA%8C%E4%B8%8E%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">6.</span> <span class="toc-text">五、实践经验与最佳实践</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E5%8C%85%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1%E7%9A%84%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93"><span class="toc-number">6.1.</span> <span class="toc-text">5.1 包结构设计的经验总结</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%81%8C%E8%B4%A3%E5%88%86%E7%A6%BB%E5%8E%9F%E5%88%99"><span class="toc-number">6.1.1.</span> <span class="toc-text">职责分离原则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%85%E5%A4%A7%E5%B0%8F%E6%8E%A7%E5%88%B6"><span class="toc-number">6.1.2.</span> <span class="toc-text">包大小控制</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E7%9A%84%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">6.2.</span> <span class="toc-text">5.2 依赖管理的最佳实践</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%9D%E8%B5%96%E7%89%88%E6%9C%AC%E7%AD%96%E7%95%A5"><span class="toc-number">6.2.1.</span> <span class="toc-text">依赖版本策略</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96%E9%81%BF%E5%85%8D"><span class="toc-number">6.2.2.</span> <span class="toc-text">循环依赖避免</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E5%8F%91%E5%B8%83%E6%B5%81%E7%A8%8B%E7%9A%84%E6%8C%81%E7%BB%AD%E4%BC%98%E5%8C%96"><span class="toc-number">6.3.</span> <span class="toc-text">5.3 发布流程的持续优化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8F%91%E5%B8%83%E6%B5%81%E6%B0%B4%E7%BA%BF"><span class="toc-number">6.3.1.</span> <span class="toc-text">自动化发布流水线</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%91%E5%B8%83%E5%89%8D%E6%A3%80%E6%9F%A5%E6%B8%85%E5%8D%95"><span class="toc-number">6.3.2.</span> <span class="toc-text">发布前检查清单</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E6%80%BB%E7%BB%93%E4%B8%8E%E5%B1%95%E6%9C%9B"><span class="toc-number">7.</span> <span class="toc-text">六、总结与展望</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%BD%93%E5%89%8D%E5%AE%9E%E7%8E%B0%E7%8A%B6%E6%80%81%E4%B8%8E%E4%BC%98%E5%8C%96%E8%AF%84%E4%BC%B0"><span class="toc-number">8.</span> <span class="toc-text">六、当前实现状态与优化评估</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E5%B7%B2%E5%AE%9E%E7%8E%B0%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="toc-number">8.1.</span> <span class="toc-text">6.1 已实现的功能</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%9C%85-%E5%9F%BA%E7%A1%80%E7%9A%84%E5%A4%9A%E5%8C%85%E6%9E%B6%E6%9E%84"><span class="toc-number">8.1.1.</span> <span class="toc-text">✅ 基础的多包架构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%9C%85-%E5%9F%BA%E7%A1%80%E7%9A%84%E6%9E%84%E5%BB%BA%E7%B3%BB%E7%BB%9F"><span class="toc-number">8.1.2.</span> <span class="toc-text">✅ 基础的构建系统</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%9C%85-%E5%8F%91%E5%B8%83%E5%92%8C%E5%88%86%E5%8F%91"><span class="toc-number">8.1.3.</span> <span class="toc-text">✅ 发布和分发</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E6%9C%AA%E5%AE%9E%E7%8E%B0%E7%9A%84%E4%BC%98%E5%8C%96"><span class="toc-number">8.2.</span> <span class="toc-text">6.2 未实现的优化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%9A%AB-%E8%B7%A8%E5%8C%85%E4%BB%A3%E7%A0%81%E5%85%B1%E4%BA%AB%E6%9C%BA%E5%88%B6"><span class="toc-number">8.2.1.</span> <span class="toc-text">🚫 跨包代码共享机制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%9A%AB-%E5%9F%BA%E4%BA%8E%E6%96%87%E4%BB%B6%E5%8F%98%E5%8C%96%E7%9A%84%E6%99%BA%E8%83%BD%E6%9E%84%E5%BB%BA"><span class="toc-number">8.2.2.</span> <span class="toc-text">🚫 基于文件变化的智能构建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%9A%AB-%E5%B9%B6%E8%A1%8C%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96"><span class="toc-number">8.2.3.</span> <span class="toc-text">🚫 并行构建优化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%9A%AB-%E8%BE%93%E5%87%BA%E4%BA%A7%E7%89%A9%E9%AB%98%E7%BA%A7%E4%BC%98%E5%8C%96"><span class="toc-number">8.2.4.</span> <span class="toc-text">🚫 输出产物高级优化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%9A%AB-%E5%A4%9A%E6%B8%A0%E9%81%93%E5%8F%91%E5%B8%83%E7%AD%96%E7%95%A5"><span class="toc-number">8.2.5.</span> <span class="toc-text">🚫 多渠道发布策略</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%9A%AB-%E5%8C%85%E5%A4%A7%E5%B0%8F%E5%92%8C%E6%9E%84%E5%BB%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7"><span class="toc-number">8.2.6.</span> <span class="toc-text">🚫 包大小和构建性能监控</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%9A%AB-CI-CD-%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%81%E6%B0%B4%E7%BA%BF"><span class="toc-number">8.2.7.</span> <span class="toc-text">🚫 CI&#x2F;CD 自动化流水线</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%9A%AB-%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB%E5%9B%BE%E5%88%86%E6%9E%90"><span class="toc-number">8.2.8.</span> <span class="toc-text">🚫 依赖关系图分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-%E5%BD%93%E5%89%8D%E6%9E%84%E5%BB%BA%E6%B5%81%E7%A8%8B%E7%9A%84%E5%AE%9E%E9%99%85%E6%83%85%E5%86%B5"><span class="toc-number">8.3.</span> <span class="toc-text">6.3 当前构建流程的实际情况</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-%E6%8A%80%E6%9C%AF%E5%80%BA%E5%8A%A1%E4%B8%8E%E6%94%B9%E8%BF%9B%E5%BB%BA%E8%AE%AE"><span class="toc-number">8.4.</span> <span class="toc-text">6.4 技术债务与改进建议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9F%AD%E6%9C%9F%E6%94%B9%E8%BF%9B%EF%BC%881-2-%E5%91%A8%E5%86%85%E5%8F%AF%E5%AE%8C%E6%88%90%EF%BC%89"><span class="toc-number">8.4.1.</span> <span class="toc-text">短期改进（1-2 周内可完成）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%AD%E6%9C%9F%E6%94%B9%E8%BF%9B%EF%BC%881-%E4%B8%AA%E6%9C%88%E5%86%85%EF%BC%89"><span class="toc-number">8.4.2.</span> <span class="toc-text">中期改进（1 个月内）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%95%BF%E6%9C%9F%E8%A7%84%E5%88%92%EF%BC%883-%E4%B8%AA%E6%9C%88-%EF%BC%89"><span class="toc-number">8.4.3.</span> <span class="toc-text">长期规划（3 个月+）</span></a></li></ol></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://apriljii.github.io/2024/01/22/02-monorepo-pnpm-workspace/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://apriljii.github.io/2024/01/22/02-monorepo-pnpm-workspace/&text=企业级Vue组件库建设-2. Monorepo多包管理:pnpm-workspace的实践"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://apriljii.github.io/2024/01/22/02-monorepo-pnpm-workspace/&title=企业级Vue组件库建设-2. Monorepo多包管理:pnpm-workspace的实践"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://apriljii.github.io/2024/01/22/02-monorepo-pnpm-workspace/&is_video=false&description=企业级Vue组件库建设-2. Monorepo多包管理:pnpm-workspace的实践"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=企业级Vue组件库建设-2. Monorepo多包管理:pnpm-workspace的实践&body=Check out this article: https://apriljii.github.io/2024/01/22/02-monorepo-pnpm-workspace/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://apriljii.github.io/2024/01/22/02-monorepo-pnpm-workspace/&title=企业级Vue组件库建设-2. Monorepo多包管理:pnpm-workspace的实践"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://apriljii.github.io/2024/01/22/02-monorepo-pnpm-workspace/&title=企业级Vue组件库建设-2. Monorepo多包管理:pnpm-workspace的实践"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://apriljii.github.io/2024/01/22/02-monorepo-pnpm-workspace/&title=企业级Vue组件库建设-2. Monorepo多包管理:pnpm-workspace的实践"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://apriljii.github.io/2024/01/22/02-monorepo-pnpm-workspace/&title=企业级Vue组件库建设-2. Monorepo多包管理:pnpm-workspace的实践"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://apriljii.github.io/2024/01/22/02-monorepo-pnpm-workspace/&name=企业级Vue组件库建设-2. Monorepo多包管理:pnpm-workspace的实践&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://apriljii.github.io/2024/01/22/02-monorepo-pnpm-workspace/&t=企业级Vue组件库建设-2. Monorepo多包管理:pnpm-workspace的实践"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2026
    April Ji
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="https://github.com/apriljii">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
